<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buyer Dashboard - Auprolis</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/dashboard.css">
    <link rel="stylesheet" href="assets/css/assets-list.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html">
                    <h2>Auprolis</h2>
                </a>
            </div>
            <div class="nav-menu">
                <a href="assets-list.html" class="nav-link">Browse Assets</a>
                <a href="#reservations" class="nav-link">My Reservations</a>
                <a href="#watchlist" class="nav-link">Watchlist</a>
            </div>
            <div class="nav-auth">
                <span class="user-info" id="userInfo">Welcome!</span>
                <button class="logout-btn" id="logoutBtn">Logout</button>
            </div>
        </div>
    </nav>

    <!-- Dashboard Content -->
    <section class="dashboard-section">
        <div class="container">
            <div class="dashboard-header">
                <h1>Welcome to Your Dashboard</h1>
                <p>Browse assets, book items, and manage your reservations</p>
            </div>

            <!-- Quick Stats -->
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon">üè†</div>
                    <div class="stat-content">
                        <h3>Active Reservations</h3>
                        <span class="stat-number" id="activeBidsCount">0</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ù§Ô∏è</div>
                    <div class="stat-content">
                        <h3>Watched Properties</h3>
                        <span class="stat-number" id="watchlistCount">0</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-content">
                        <h3>Total Reservations</h3>
                        <span class="stat-number" id="totalBidsCount">0</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-content">
                        <h3>Completed Reservations</h3>
                        <span class="stat-number" id="wonAuctionsCount">0</span>
                    </div>
                </div>
            </div>

            <!-- Dashboard Tabs -->
            <div class="dashboard-tabs">
                <button class="tab-btn active" data-tab="overview">Overview</button>
                <button class="tab-btn" data-tab="reservations">My Reservations</button>
                <button class="tab-btn" data-tab="watchlist">Watchlist</button>
                <button class="tab-btn" data-tab="reports">Reports</button>
            </div>

            <!-- Overview Tab -->
            <div class="tab-content active" id="overview">
                <!-- Search and Filters Section -->
                <div class="search-filters-section" style="margin-bottom: 2rem;">
                    <!-- Search Bar -->
                    <div class="search-container">
                        <div class="search-input-group">
                            <input type="text" id="buyerSearchInput" placeholder="Search assets by title, location, or description..." class="search-input">
                            <button class="search-btn" id="buyerSearchBtn">
                                <span class="search-icon">üîç</span>
                            </button>
                        </div>
                        <div class="search-suggestions" id="buyerSearchSuggestions">
                            <!-- Search suggestions will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Advanced Filters -->
                    <div class="filters-container">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label for="buyerCategoryFilter">Category</label>
                                <select id="buyerCategoryFilter" class="filter-select">
                                    <option value="">All Categories</option>
                                    <option value="property">Property</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="buyerLocationFilter">Location</label>
                                <select id="buyerLocationFilter" class="filter-select">
                                    <option value="">All Locations</option>
                                    <option value="gaborone">Gaborone</option>
                                    <option value="francistown">Francistown</option>
                                    <option value="maun">Maun</option>
                                    <option value="kasane">Kasane</option>
                                    <option value="selebi-phikwe">Selebi-Phikwe</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label for="buyerConditionFilter">Condition</label>
                                <select id="buyerConditionFilter" class="filter-select">
                                    <option value="">All Conditions</option>
                                    <option value="excellent">Excellent</option>
                                    <option value="good">Good</option>
                                    <option value="fair">Fair</option>
                                    <option value="poor">Poor</option>
                                </select>
                            </div>
                        </div>

                        <div class="filter-row">
                            <div class="filter-group">
                                <label for="buyerPriceRangeFilter">Price Range</label>
                                <select id="buyerPriceRangeFilter" class="filter-select">
                                    <option value="">Any Price</option>
                                    <option value="0-50000">Under BWP 50,000</option>
                                    <option value="50000-100000">BWP 50,000 - 100,000</option>
                                    <option value="100000-250000">BWP 100,000 - 250,000</option>
                                    <option value="250000-500000">BWP 250,000 - 500,000</option>
                                    <option value="500000+">Over BWP 500,000</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label for="buyerEndingFilter">Available Until</label>
                                <select id="buyerEndingFilter" class="filter-select">
                                    <option value="">Any Time</option>
                                    <option value="today">Today</option>
                                    <option value="tomorrow">Tomorrow</option>
                                    <option value="week">This Week</option>
                                    <option value="month">This Month</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="buyerSortFilter">Sort By</label>
                                <select id="buyerSortFilter" class="filter-select">
                                    <option value="newest">Newest First</option>
                                    <option value="oldest">Oldest First</option>
                                    <option value="price-low">Price: Low to High</option>
                                    <option value="price-high">Price: High to Low</option>
                                    <option value="ending-soon">Ending Soon</option>
                                    <option value="most-reservations">Most Reservations</option>
                                    <option value="least-reservations">Least Reservations</option>
                                </select>
                            </div>
                        </div>

                        <div class="filter-actions">
                            <button class="btn btn-secondary" id="buyerClearFiltersBtn">Clear All Filters</button>
                            <button class="btn btn-primary" id="buyerApplyFiltersBtn">Apply Filters</button>
                        </div>
                    </div>

                    <!-- Active Filters Display -->
                    <div class="active-filters" id="buyerActiveFilters">
                        <!-- Active filters will be displayed here -->
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Browse Assets</h3>
                        <p>Discover available assets for reservation</p>
                        <a href="assets-list.html" class="btn btn-primary">View Assets</a>
                    </div>

                    <div class="dashboard-card">
                        <h3>My Reservations</h3>
                        <p>Track your active reservations and booking status</p>
                        <button class="btn btn-secondary" onclick="dashboardHandler.switchTab('reservations')">View Reservations</button>
                    </div>

                    <div class="dashboard-card">
                        <h3>Watchlist</h3>
                        <p>Save assets you're interested in</p>
                        <button class="btn btn-secondary" onclick="dashboardHandler.switchTab('watchlist')">View Watchlist</button>
                    </div>

                    <div class="dashboard-card">
                        <h3>Reports</h3>
                        <p>Generate property and reservation reports</p>
                        <button class="btn btn-secondary" onclick="dashboardHandler.switchTab('reports')">Generate Reports</button>
                    </div>
                </div>
            </div>

            <!-- My Reservations Tab -->
            <div class="tab-content" id="reservations">
                <div class="bids-section">
                    <div class="section-header">
                        <h2>My Reservations</h2>
                        <div class="bids-filters">
                            <select id="reservationStatusFilter" class="filter-select">
                                <option value="">All Reservations</option>
                                <option value="pending">Pending</option>
                                <option value="confirmed">Confirmed</option>
                                <option value="cancelled">Cancelled</option>
                                <option value="completed">Completed</option>
                            </select>
                            <select id="reservationSortFilter" class="filter-select">
                                <option value="newest">Newest First</option>
                                <option value="oldest">Oldest First</option>
                            </select>
                        </div>
                    </div>

                    <div class="bids-list" id="reservationsList">
                        <!-- Reservations will be populated by JavaScript -->
                    </div>

                    <div class="bids-summary">
                        <div class="summary-card">
                            <h4>Reservation Summary</h4>
                            <div class="summary-stats">
                                <div class="summary-stat">
                                    <span class="stat-label">Total Reservations</span>
                                    <span class="stat-value" id="totalReservations">0</span>
                                </div>
                                <div class="summary-stat">
                                    <span class="stat-label">Active Reservations</span>
                                    <span class="stat-value" id="activeReservations">0</span>
                                </div>
                                <div class="summary-stat">
                                    <span class="stat-label">Confirmed</span>
                                    <span class="stat-value" id="confirmedReservations">0</span>
                                </div>
                                <div class="summary-stat">
                                    <span class="stat-label">Completed</span>
                                    <span class="stat-value" id="completedReservations">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Watchlist Tab -->
            <div class="tab-content" id="watchlist">
                <div class="watchlist-section">
                    <div class="section-header">
                        <h2>My Watchlist</h2>
                        <div class="watchlist-actions">
                            <button class="btn btn-primary" onclick="dashboardHandler.addToWatchlist()">Add Items</button>
                        </div>
                    </div>
                    <div class="watchlist-grid" id="watchlistGrid">
                        <!-- Watchlist items will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Reports Tab -->
            <div class="tab-content" id="reports">
                <div class="reports-section">
                    <div class="section-header">
                        <h2>Generate Reports</h2>
                    </div>
                    <div class="reports-grid" id="reportsGrid">
                        <!-- Report options will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="recent-activity">
                <h3>Recent Activity</h3>
                <div class="activity-feed" id="activityFeed">
                    <!-- Activity items will be populated by JavaScript -->
                </div>
            </div>

            <!-- Alerts & Notifications -->
            <div class="alerts-section">
                <h3>Alerts & Reminders</h3>
                <div class="alerts-list" id="alertsList">
                    <!-- Alert items will be populated by JavaScript -->
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h3>Quick Actions</h3>
                <div class="actions-grid">
                    <button class="action-btn" id="propertyReportBtn">
                        <span class="action-icon">üìä</span>
                        <span>Property Report</span>
                    </button>
                    <button class="action-btn" id="reservationHistoryBtn">
                        <span class="action-icon">üìà</span>
                        <span>Reservation History</span>
                    </button>
                    <button class="action-btn" id="watchlistBtn">
                        <span class="action-icon">‚ù§Ô∏è</span>
                        <span>My Watchlist</span>
                    </button>
                    <button class="action-btn" id="alertsBtn">
                        <span class="action-icon">üîî</span>
                        <span>Manage Alerts</span>
                    </button>
                </div>
            </div>

            <!-- Subscription Status -->
            <div class="subscription-status">
                <h3>Subscription Status</h3>
                <div class="status-info" id="subscriptionStatus">
                    <span class="status-badge pending">Pending</span>
                    <p>Your subscription is being processed. You'll have full access once payment is confirmed.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Enhanced Property Details Modal -->
    <div class="modal" id="propertyModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="propertyModalTitle">Property Details</h3>
                <button class="modal-close" id="propertyModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="property-details-content" id="propertyDetailsContent">
                    <!-- Property details will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Watchlist Modal -->
    <div class="modal" id="watchlistModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>My Watchlist</h3>
                <button class="modal-close" id="watchlistModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="watchlist-content" id="watchlistContent">
                    <!-- Watchlist items will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Reports Modal -->
    <div class="modal" id="reportsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Generate Reports</h3>
                <button class="modal-close" id="reportsModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="reports-content" id="reportsContent">
                    <!-- Report options will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Reservation Modal -->
    <div class="modal" id="reservationModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="reservationModalTitle">Book Item</h3>
                <button class="modal-close" id="reservationModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="reservation-content" id="reservationContent">
                    <!-- Reservation interface will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Reservation History Modal -->
    <div class="modal" id="reservationHistoryModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>My Reservations</h3>
                <button class="modal-close" id="reservationHistoryModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="reservation-history-content" id="reservationHistoryContent">
                    <!-- Reservation history will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Reservation Confirmation Modal -->
    <div class="modal" id="reservationConfirmationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Your Reservation</h3>
                <button class="modal-close" id="reservationConfirmationModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="reservation-confirmation-content" id="reservationConfirmationContent">
                    <!-- Reservation confirmation will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Demo mode support -->
    <script src="assets/js/demo-data.js"></script>
    <script src="assets/js/demo-mode.js"></script>
    <script src="assets/js/firebase-config.js"></script>
    <script src="assets/js/assets-data.js"></script>
    <script src="assets/js/reservation.js"></script>
    <script src="assets/js/dashboard.js"></script>
    <script src="assets/js/buyer-dashboard-filters.js"></script>
    <script src="assets/js/script.js"></script>
</body>
</html>
